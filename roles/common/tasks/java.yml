 - name: Installing Maven  on  {{COMPONENT}}-{{ENV}} server
   ansible.builtin.package:
      name: maven
      state: present


 - name: Creating App user 
   ansible.builtin.include_role:
     name: common
     tasks_from: create_user 


 - name: Download and Extracting the {{ COMPONENT }} 
   ansible.builtin.include_role:
     name: common
     tasks_from: download


# - name: Generating {{COMPONENT}} artifacts 
#   ansible.builtin.shell: cd /home/{{APPUSER}}/{{COMPONENT}}/  &&  mvn clean package
  
  # you can use the "args" chdir instead of using cd /home/{{APPUSER}}/{COMPONENT} &&  mvn clean package
  #   args: 
  #        chdir: somedir /
 - name: Generating {{COMPONENT}} artifacts 
   ansible.builtin.shell: mvn clean package  &&  mv target/{{COMPONENT}}-1.0.jar {{COMPONENT}}.jar
   args:
     chdir: /home/{{APPUSER}}/{{COMPONENT}}/ 


 - name: Copying the systemd File
   ansible.builtin.template:
      src:  systemd.service
      dest: /etc/systemd/system/{{COMPONENT}}.service
       
 - name: Restarting {{COMPONENT}}
   ansible.builtin.systemd:
      name: "{{COMPONENT}}"
      state: restarted
      enabled: true
      daemon_reload: true

 - name: configuring Node name Repo
   ansible.builtin.shell: set-hostname {{COMPONENT}}-{{ENV}}